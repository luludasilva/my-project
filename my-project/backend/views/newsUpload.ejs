<div>
  <h2>agregar noticia</h2>
  <form method="POST" action="/news" enctype="multipart/form-data" onsubmit="handleSubmit(event)">
    <label for="title">titulo:</label>
    <input type="text" id="title" name="title" onchange="handleChange(this)" required /><br />

    <label for="subtitle">subtitulo:</label>
    <input type="text" id="subtitle" name="subtitle" onchange="handleChange(this)" required /><br />

    <label for="content">contenido:</label>
    <textarea id="content" name="content" rows="4" onchange="handleChange(this)" required></textarea><br />

    <label for="image">imagen:</label>
    <input type="file" id="image" name="image" accept="image/*" onchange="handleFileChange(this)" required /><br />

    <button type="submit">agregar noticia</button>
  </form>
</div>

<script>

  let formData = {};

  function setFormData(updatedData) {
    formData = { ...formData, ...updatedData };
  }

  function handleChange(input) {
    const name = input.name;
    const value = input.value;
    setFormData({ [name]: value });
  }

  function handleFileChange(input) {
    const file = input.files[0];
    setFormData({ image: file });
  }

  async function handleSubmit(event) {
    event.preventDefault();

    const data = new FormData();
    data.append('title', formData.title);
    data.append('subtitle', formData.subtitle);
    data.append('content', formData.content);
    data.append('image', formData.image);

    try {
      const response = await fetch('/news', {
        method: 'POST',
        body: data,
      });

      if (response.ok) {
        const result = await response.json();
        console.log('Data added successfully:', result);
      } else {
        const error = await response.json();
        console.error('Error:', error);
      }
    } catch (error) {
      console.error('An error occurred. Please try again.');
    }
  }
</script>